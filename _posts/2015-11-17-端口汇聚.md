---
layout: post
title: 端口汇聚
comments: true
category: 硬件相关
---
对于一个云服务系统

为了能够支撑大量用户的访问

一般在接入层会采用集群来进行部署

集群的一般构成就是 负载均衡服务器(haproxy)+n个后台服务器

这些，大部分都是在软件层面进行的能力扩容

今天实际环境中遇到另外一个问题，就是单网口（千M）的处理能力达到了上限

数据包出现了丢包的情况，实际情况看下来，数据包确实已经超过了网口的承受能力

这种情况，再用什么软件层面的负载均衡都是无效的

刚好这个服务器上配备了两个网口

在硬件层面，也有一种负载均衡策略，那就是端口汇聚

它的工作原理类似下图

![](http://i0.wp.com/mxm.neland.cn/wp-content/uploads/2015/11/d000baa1cd11728ba87e6e61c8fcc3cec3fd2c26.jpg)

需要在入口的交换机上进行设置，将数据包进行分流处理，具体配置细节可度娘。

该方案不仅可解决流量的均衡，还能起到容灾的作用。